{"version":3,"sources":["webpack:///./src/pages/datasource/index.vue?edc8","webpack:///src/pages/datasource/index.vue","webpack:///./src/pages/datasource/index.vue?2471","webpack:///./src/pages/datasource/index.vue?207e","webpack:///./src/pages/datasource/index.vue?5d57"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","addDs","_v","_l","ds","key","id","_s","name","description","attrs","$event","ping","staticStyle","showTables","type","importTable","style","borderBottom","indeterminate","checkAll","onCheckAllChange","tables","onChange","model","value","callback","$$v","checkTables","expression","visible","form","handleOk","$set","dsType","title","pingLoading","staticRenderFns","data","datasources","datasourceId","jdbcUrl","username","password","dsTypeList","created","initList","methods","$axios","get","then","checkedList","length","Object","assign","e","target","checked","component"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,wBAAwB,CAACF,EAAG,WAAW,CAACG,GAAG,CAAC,MAAQP,EAAIQ,QAAQ,CAACR,EAAIS,GAAG,WAAWL,EAAG,MAAM,CAACE,YAAY,WAAWN,EAAIU,GAAIV,EAAe,aAAE,SAASW,GAAI,OAAOP,EAAG,MAAM,CAACQ,IAAID,EAAGE,GAAGP,YAAY,WAAW,CAACF,EAAG,MAAM,CAACE,YAAY,SAAS,CAACN,EAAIS,GAAGT,EAAIc,GAAGH,EAAGI,SAASX,EAAG,MAAM,CAACE,YAAY,eAAe,CAACN,EAAIS,GAAGT,EAAIc,GAAGH,EAAGK,gBAAgBZ,EAAG,WAAW,CAACa,MAAM,CAAC,KAAO,SAASV,GAAG,CAAC,MAAQ,SAASW,GAAQ,OAAOlB,EAAImB,KAAKR,EAAGE,OAAO,CAACb,EAAIS,GAAG,UAAUL,EAAG,WAAW,CAACgB,YAAY,CAAC,cAAc,QAAQH,MAAM,CAAC,KAAO,SAASV,GAAG,CAAC,MAAQ,SAASW,GAAQ,OAAOlB,EAAIqB,WAAWV,EAAGE,GAAGF,EAAGW,SAAS,CAACtB,EAAIS,GAAG,SAASL,EAAG,WAAW,CAACgB,YAAY,CAAC,cAAc,QAAQH,MAAM,CAAC,KAAO,SAASV,GAAG,CAAC,MAAQ,SAASW,GAAQ,OAAOlB,EAAIuB,YAAYZ,EAAGE,OAAO,CAACb,EAAIS,GAAG,QAAQL,EAAG,MAAM,CAACE,YAAY,cAAc,CAACF,EAAG,MAAM,CAACoB,MAAM,CAAGC,aAAc,sBAAwB,CAACrB,EAAG,aAAa,CAACa,MAAM,CAAC,cAAgBjB,EAAI0B,cAAc,QAAU1B,EAAI2B,UAAUpB,GAAG,CAAC,OAASP,EAAI4B,mBAAmB,CAAC5B,EAAIS,GAAG,SAAS,GAAGL,EAAG,mBAAmB,CAACa,MAAM,CAAC,QAAUjB,EAAI6B,QAAQtB,GAAG,CAAC,OAASP,EAAI8B,UAAUC,MAAM,CAACC,MAAOhC,EAAe,YAAEiC,SAAS,SAAUC,GAAMlC,EAAImC,YAAYD,GAAKE,WAAW,kBAAkB,IAAI,MAAK,GAAGhC,EAAG,UAAU,CAACa,MAAM,CAAC,gBAAiB,EAAK,QAAUjB,EAAIqC,QAAQ,MAAQ,IAAI,MAAQ,SAAS9B,GAAG,CAAC,OAAS,WAAaP,EAAIqC,SAAU,EAAOrC,EAAIsC,KAAM,IAAK,GAAKtC,EAAIuC,WAAW,CAACnC,EAAG,eAAe,CAACA,EAAG,oBAAoB,CAACa,MAAM,CAAC,MAAQ,OAAO,CAACb,EAAG,UAAU,CAAC2B,MAAM,CAACC,MAAOhC,EAAIsC,KAAS,KAAEL,SAAS,SAAUC,GAAMlC,EAAIwC,KAAKxC,EAAIsC,KAAM,OAAQJ,IAAME,WAAW,gBAAgB,GAAGhC,EAAG,oBAAoB,CAACa,MAAM,CAAC,MAAQ,UAAU,CAACb,EAAG,WAAW,CAAC2B,MAAM,CAACC,MAAOhC,EAAIsC,KAAS,KAAEL,SAAS,SAAUC,GAAMlC,EAAIwC,KAAKxC,EAAIsC,KAAM,OAAQJ,IAAME,WAAW,cAAcpC,EAAIU,GAAIV,EAAc,YAAE,SAASyC,GAAQ,OAAOrC,EAAG,kBAAkB,CAACQ,IAAI6B,EAAO1B,KAAKE,MAAM,CAAC,MAAQwB,EAAO1B,OAAO,CAACf,EAAIS,GAAGT,EAAIc,GAAG2B,EAAOC,aAAY,IAAI,GAAGtC,EAAG,oBAAoB,CAACa,MAAM,CAAC,MAAQ,UAAU,CAACb,EAAG,iBAAiB,CAACa,MAAM,CAAC,eAAe,OAAO,QAAUjB,EAAI2C,aAAapC,GAAG,CAAC,OAAS,SAASW,GAAQ,OAAOlB,EAAImB,KAAK,MAAMY,MAAM,CAACC,MAAOhC,EAAIsC,KAAY,QAAEL,SAAS,SAAUC,GAAMlC,EAAIwC,KAAKxC,EAAIsC,KAAM,UAAWJ,IAAME,WAAW,mBAAmB,GAAGhC,EAAG,oBAAoB,CAACa,MAAM,CAAC,MAAQ,QAAQ,CAACb,EAAG,UAAU,CAAC2B,MAAM,CAACC,MAAOhC,EAAIsC,KAAa,SAAEL,SAAS,SAAUC,GAAMlC,EAAIwC,KAAKxC,EAAIsC,KAAM,WAAYJ,IAAME,WAAW,oBAAoB,GAAGhC,EAAG,oBAAoB,CAACa,MAAM,CAAC,MAAQ,OAAO,CAACb,EAAG,UAAU,CAACa,MAAM,CAAC,KAAO,YAAYc,MAAM,CAACC,MAAOhC,EAAIsC,KAAa,SAAEL,SAAS,SAAUC,GAAMlC,EAAIwC,KAAKxC,EAAIsC,KAAM,WAAYJ,IAAME,WAAW,oBAAoB,IAAI,IAAI,IAAI,IACvqFQ,EAAkB,GC+DtB,GACA,CACE,KAAF,QACE,MAAF,SAEA,CACE,KAAF,SACE,MAAF,WAGA,GACEC,KADF,WAEI,MAAO,CACLC,YAAa,GACbT,SAAS,EACTU,aAAc,GACdT,KAAM,CACJU,QAAS,GACTC,SAAU,GACVC,SAAU,GACV5B,KAAM,OACNP,KAAM,IAERoC,WAAN,EACMR,aAAa,EACbR,YAAa,GACbN,OAAQ,GACRF,UAAU,EACVD,eAAe,IAGnB0B,QArBF,WAsBInD,KAAKoD,YAEPC,QAAS,CACPD,SADJ,WACA,WACMpD,KAAKsD,OAAOC,IAAI,oBAAoBC,MAAK,SAA/C,GACQ,EAAR,kBAGIjD,MANJ,WAOMP,KAAKoC,SAAU,GAEjBE,SATJ,WASA,WACMtC,KAAKsD,OACX,8BACA,kBACA,IACU,EAAV,0BACU,EAAV,WACU,EAAV,eAGA,kBACQ,EAAR,eAGIpC,KAvBJ,SAuBA,cACMlB,KAAK0C,aAAc,EACnB1C,KAAKsD,OACX,KADA,wCACA,cACA,kBACA,EACU,EAAV,0BAEU,EAAV,wBAEQ,EAAR,kBAEA,kBACQ,EAAR,mBAGIlC,WAvCJ,SAuCA,cACMpB,KAAKsD,OAAOC,IAAI,mCAAtB,6BACQ,EAAR,aAGI1B,SA5CJ,SA4CA,GACM7B,KAAKyB,gBACX,sCACMzB,KAAK0B,SAAW+B,EAAYC,SAAW1D,KAAK4B,OAAO8B,QAErD/B,iBAjDJ,SAiDA,GACMgC,OAAOC,OAAO5D,KAAM,CAClBkC,YAAa2B,EAAEC,OAAOC,QAAU/D,KAAK4B,OAAS,GAC9CH,eAAe,EACfC,SAAUmC,EAAEC,OAAOC,WAGvBzC,YAxDJ,SAwDA,gBACMtB,KAAKsD,OACX,0BACQ,aAAR,EACQ,SAAR,EACQ,OAAR,iBACQ,UAAR,cACQ,UAAR,EACQ,WAAR,IAEA,kBACA,GACU,EAAV,gCCtK8V,I,wBCQ1VU,EAAY,eACd,EACAlE,EACA6C,GACA,EACA,KACA,KACA,MAIa,aAAAqB,E,6CCnBf,yBAAmiB,EAAG,G","file":"js/chunk-372d33ed.28128345.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"datasource-container\"},[_c('a-button',{on:{\"click\":_vm.addDs}},[_vm._v(\"新增数据源\")]),_c('div',{staticClass:\"ds-list\"},_vm._l((_vm.datasources),function(ds){return _c('div',{key:ds.id,staticClass:\"ds-item\"},[_c('div',{staticClass:\"title\"},[_vm._v(_vm._s(ds.name))]),_c('div',{staticClass:\"description\"},[_vm._v(_vm._s(ds.description))]),_c('a-button',{attrs:{\"size\":\"small\"},on:{\"click\":function($event){return _vm.ping(ds.id)}}},[_vm._v(\"连接测试\")]),_c('a-button',{staticStyle:{\"margin-left\":\"10px\"},attrs:{\"size\":\"small\"},on:{\"click\":function($event){return _vm.showTables(ds.id,ds.type)}}},[_vm._v(\"所有表\")]),_c('a-button',{staticStyle:{\"margin-left\":\"10px\"},attrs:{\"size\":\"small\"},on:{\"click\":function($event){return _vm.importTable(ds.id)}}},[_vm._v(\"导入\")]),_c('div',{staticClass:\"table-list\"},[_c('div',{style:({ borderBottom: '1px solid #E9E9E9' })},[_c('a-checkbox',{attrs:{\"indeterminate\":_vm.indeterminate,\"checked\":_vm.checkAll},on:{\"change\":_vm.onCheckAllChange}},[_vm._v(\"全选\")])],1),_c('a-checkbox-group',{attrs:{\"options\":_vm.tables},on:{\"change\":_vm.onChange},model:{value:(_vm.checkTables),callback:function ($$v) {_vm.checkTables=$$v},expression:\"checkTables\"}})],1)],1)}),0),_c('a-modal',{attrs:{\"destroyOnClose\":true,\"visible\":_vm.visible,\"width\":400,\"title\":\"添加数据源\"},on:{\"cancel\":function () {_vm.visible = false; _vm.form ={};},\"ok\":_vm.handleOk}},[_c('a-form-model',[_c('a-form-model-item',{attrs:{\"label\":\"名称\"}},[_c('a-input',{model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_c('a-form-model-item',{attrs:{\"label\":\"数据源类型\"}},[_c('a-select',{model:{value:(_vm.form.type),callback:function ($$v) {_vm.$set(_vm.form, \"type\", $$v)},expression:\"form.type\"}},_vm._l((_vm.dsTypeList),function(dsType){return _c('a-select-option',{key:dsType.name,attrs:{\"value\":dsType.name}},[_vm._v(_vm._s(dsType.title))])}),1)],1),_c('a-form-model-item',{attrs:{\"label\":\"连接url\"}},[_c('a-input-search',{attrs:{\"enter-button\":\"连接测试\",\"loading\":_vm.pingLoading},on:{\"search\":function($event){return _vm.ping('')}},model:{value:(_vm.form.jdbcUrl),callback:function ($$v) {_vm.$set(_vm.form, \"jdbcUrl\", $$v)},expression:\"form.jdbcUrl\"}})],1),_c('a-form-model-item',{attrs:{\"label\":\"用户名\"}},[_c('a-input',{model:{value:(_vm.form.username),callback:function ($$v) {_vm.$set(_vm.form, \"username\", $$v)},expression:\"form.username\"}})],1),_c('a-form-model-item',{attrs:{\"label\":\"密码\"}},[_c('a-input',{attrs:{\"type\":\"password\"},model:{value:(_vm.form.password),callback:function ($$v) {_vm.$set(_vm.form, \"password\", $$v)},expression:\"form.password\"}})],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"datasource-container\">\n    <a-button @click=\"addDs\">新增数据源</a-button>\n    <div class=\"ds-list\">\n      <div v-for=\"ds in datasources\" :key=\"ds.id\" class=\"ds-item\">\n        <div class=\"title\">{{ds.name}}</div>\n        <div class=\"description\">{{ds.description}}</div>\n        <a-button size=\"small\" @click=\"ping(ds.id)\">连接测试</a-button>\n        <a-button size=\"small\" style=\"margin-left: 10px;\" @click=\"showTables(ds.id,ds.type)\">所有表</a-button>\n        <a-button size=\"small\" style=\"margin-left: 10px;\" @click=\"importTable(ds.id)\">导入</a-button>\n        <div class=\"table-list\">\n          <div :style=\"{ borderBottom: '1px solid #E9E9E9' }\">\n            <a-checkbox\n              :indeterminate=\"indeterminate\"\n              :checked=\"checkAll\"\n              @change=\"onCheckAllChange\"\n            >全选</a-checkbox>\n          </div>\n          <a-checkbox-group v-model=\"checkTables\" :options=\"tables\" @change=\"onChange\" />\n        </div>\n      </div>\n    </div>\n\n    <a-modal\n      :destroyOnClose=\"true\"\n      :visible=\"visible\"\n      :width=\"400\"\n      @cancel=\"() => {visible = false; form ={};}\"\n      @ok=\"handleOk\"\n      title=\"添加数据源\"\n    >\n      <a-form-model>\n        <a-form-model-item label=\"名称\">\n          <a-input v-model=\"form.name\"></a-input>\n        </a-form-model-item>\n        <a-form-model-item label=\"数据源类型\">\n          <a-select v-model=\"form.type\">\n            <a-select-option\n              v-for=\"dsType in dsTypeList\"\n              :key=\"dsType.name\"\n              :value=\"dsType.name\"\n            >{{dsType.title}}</a-select-option>\n          </a-select>\n        </a-form-model-item>\n        <a-form-model-item label=\"连接url\">\n          <a-input-search\n            enter-button=\"连接测试\"\n            v-model=\"form.jdbcUrl\"\n            :loading=\"pingLoading\"\n            @search=\"ping('')\"\n          ></a-input-search>\n        </a-form-model-item>\n        <a-form-model-item label=\"用户名\">\n          <a-input v-model=\"form.username\"></a-input>\n        </a-form-model-item>\n        <a-form-model-item label=\"密码\">\n          <a-input type=\"password\" v-model=\"form.password\"></a-input>\n        </a-form-model-item>\n      </a-form-model>\n    </a-modal>\n  </div>\n</template>\n\n<script>\nconst dsTypeList = [\n  {\n    name: \"mysql\",\n    title: \"MySql\"\n  },\n  {\n    name: \"presto\",\n    title: \"Presto\"\n  }\n];\nexport default {\n  data() {\n    return {\n      datasources: [],\n      visible: false,\n      datasourceId: \"\",\n      form: {\n        jdbcUrl: \"\",\n        username: \"\",\n        password: \"\",\n        type: \"none\",\n        name: \"\"\n      },\n      dsTypeList,\n      pingLoading: false,\n      checkTables: [],\n      tables: [],\n      checkAll: false,\n      indeterminate: false\n    };\n  },\n  created() {\n    this.initList();\n  },\n  methods: {\n    initList() {\n      this.$axios.get(\"/datasource/list\").then(data => {\n        this.datasources = data;\n      });\n    },\n    addDs() {\n      this.visible = true;\n    },\n    handleOk() {\n      this.$axios\n        .post(\"/datasource\", this.form)\n        .then(data => {\n          if (data) {\n            this.$message.success(\"添加成功！\");\n            this.visible = false;\n            this.initList();\n          }\n        })\n        .catch(() => {\n          this.visible = false;\n        });\n    },\n    ping(dsId) {\n      this.pingLoading = true;\n      this.$axios\n        .post(`/datasource/ping?datasourceId=${dsId}`, this.form)\n        .then(data => {\n          if (data) {\n            this.$message.success(\"测试成功！\");\n          } else {\n            this.$message.error(\"测试失败！\");\n          }\n          this.pingLoading = false;\n        })\n        .catch(() => {\n          this.pingLoading = false;\n        });\n    },\n    showTables(dsId) {\n      this.$axios.get(`/datasource/tables?datasourceId=${dsId}`).then(data => {\n        this.tables = data;\n      });\n    },\n    onChange(checkedList) {\n      this.indeterminate =\n        !!checkedList.length && checkedList.length < this.tables.length;\n      this.checkAll = checkedList.length === this.tables.length;\n    },\n    onCheckAllChange(e) {\n      Object.assign(this, {\n        checkTables: e.target.checked ? this.tables : [],\n        indeterminate: false,\n        checkAll: e.target.checked\n      });\n    },\n    importTable(dsId, dsType) {\n      this.$axios\n        .post(\"/workSheet/import\", {\n          datasourceId: dsId,\n          folderId: 0,\n          tables: this.checkTables,\n          allTables: this.checkAll,\n          sheetType: dsType,\n          newFolder: true\n        })\n        .then(data => {\n          if (data) {\n            this.$message.success(\"导入成功！\");\n          }\n        });\n    }\n  }\n};\n</script>\n\n<style lang=\"less\">\n.datasource-container {\n  .ds-list {\n    margin-top: 20px;\n    display: flex;\n    .ds-item {\n      .title {\n        font-size: 15px;\n        padding: 10px;\n      }\n      .description {\n        padding: 0 10px;\n        margin-bottom: 10px;\n        font-size: 14px;\n        color: #888;\n      }\n      border: 1px solid #e6e6e6;\n      background: #fff;\n      padding: 10px;\n      margin-right: 10px;\n    }\n    .table-list {\n      margin-top: 10px;\n      padding: 10px;\n      border: 1px solid #e6e6e6;\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=85b555f8&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=less&\""],"sourceRoot":""}