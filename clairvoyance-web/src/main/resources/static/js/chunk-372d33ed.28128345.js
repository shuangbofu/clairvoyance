(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-372d33ed"],{6969:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"datasource-container"},[s("a-button",{on:{click:t.addDs}},[t._v("新增数据源")]),s("div",{staticClass:"ds-list"},t._l(t.datasources,(function(e){return s("div",{key:e.id,staticClass:"ds-item"},[s("div",{staticClass:"title"},[t._v(t._s(e.name))]),s("div",{staticClass:"description"},[t._v(t._s(e.description))]),s("a-button",{attrs:{size:"small"},on:{click:function(s){return t.ping(e.id)}}},[t._v("连接测试")]),s("a-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(s){return t.showTables(e.id,e.type)}}},[t._v("所有表")]),s("a-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:function(s){return t.importTable(e.id)}}},[t._v("导入")]),s("div",{staticClass:"table-list"},[s("div",{style:{borderBottom:"1px solid #E9E9E9"}},[s("a-checkbox",{attrs:{indeterminate:t.indeterminate,checked:t.checkAll},on:{change:t.onCheckAllChange}},[t._v("全选")])],1),s("a-checkbox-group",{attrs:{options:t.tables},on:{change:t.onChange},model:{value:t.checkTables,callback:function(e){t.checkTables=e},expression:"checkTables"}})],1)],1)})),0),s("a-modal",{attrs:{destroyOnClose:!0,visible:t.visible,width:400,title:"添加数据源"},on:{cancel:function(){t.visible=!1,t.form={}},ok:t.handleOk}},[s("a-form-model",[s("a-form-model-item",{attrs:{label:"名称"}},[s("a-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),s("a-form-model-item",{attrs:{label:"数据源类型"}},[s("a-select",{model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.dsTypeList,(function(e){return s("a-select-option",{key:e.name,attrs:{value:e.name}},[t._v(t._s(e.title))])})),1)],1),s("a-form-model-item",{attrs:{label:"连接url"}},[s("a-input-search",{attrs:{"enter-button":"连接测试",loading:t.pingLoading},on:{search:function(e){return t.ping("")}},model:{value:t.form.jdbcUrl,callback:function(e){t.$set(t.form,"jdbcUrl",e)},expression:"form.jdbcUrl"}})],1),s("a-form-model-item",{attrs:{label:"用户名"}},[s("a-input",{model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),s("a-form-model-item",{attrs:{label:"密码"}},[s("a-input",{attrs:{type:"password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1)],1)],1)],1)},n=[],i=[{name:"mysql",title:"MySql"},{name:"presto",title:"Presto"}],o={data:function(){return{datasources:[],visible:!1,datasourceId:"",form:{jdbcUrl:"",username:"",password:"",type:"none",name:""},dsTypeList:i,pingLoading:!1,checkTables:[],tables:[],checkAll:!1,indeterminate:!1}},created:function(){this.initList()},methods:{initList:function(){var t=this;this.$axios.get("/datasource/list").then((function(e){t.datasources=e}))},addDs:function(){this.visible=!0},handleOk:function(){var t=this;this.$axios.post("/datasource",this.form).then((function(e){e&&(t.$message.success("添加成功！"),t.visible=!1,t.initList())})).catch((function(){t.visible=!1}))},ping:function(t){var e=this;this.pingLoading=!0,this.$axios.post("/datasource/ping?datasourceId=".concat(t),this.form).then((function(t){t?e.$message.success("测试成功！"):e.$message.error("测试失败！"),e.pingLoading=!1})).catch((function(){e.pingLoading=!1}))},showTables:function(t){var e=this;this.$axios.get("/datasource/tables?datasourceId=".concat(t)).then((function(t){e.tables=t}))},onChange:function(t){this.indeterminate=!!t.length&&t.length<this.tables.length,this.checkAll=t.length===this.tables.length},onCheckAllChange:function(t){Object.assign(this,{checkTables:t.target.checked?this.tables:[],indeterminate:!1,checkAll:t.target.checked})},importTable:function(t,e){var s=this;this.$axios.post("/workSheet/import",{datasourceId:t,folderId:0,tables:this.checkTables,allTables:this.checkAll,sheetType:e,newFolder:!0}).then((function(t){t&&s.$message.success("导入成功！")}))}}},c=o,l=(s("991f"),s("2877")),r=Object(l["a"])(c,a,n,!1,null,null,null);e["default"]=r.exports},"991f":function(t,e,s){"use strict";var a=s("e7bc"),n=s.n(a);n.a},e7bc:function(t,e,s){}}]);
//# sourceMappingURL=chunk-372d33ed.28128345.js.map