(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-db514600"],{"057f":function(e,t,n){var r=n("fc6a"),a=n("241c").f,i={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return a(e)}catch(t){return o.slice()}};e.exports.f=function(e){return o&&"[object Window]"==i.call(e)?s(e):a(r(e))}},1688:function(e,t,n){"use strict";var r=n("8092"),a=n.n(r);a.a},1860:function(e,t,n){},2532:function(e,t,n){"use strict";var r=n("23e7"),a=n("5a34"),i=n("1d80"),o=n("ab13");r({target:"String",proto:!0,forced:!o("includes")},{includes:function(e){return!!~String(i(this)).indexOf(a(e),arguments.length>1?arguments[1]:void 0)}})},"25f0":function(e,t,n){"use strict";var r=n("6eeb"),a=n("825a"),i=n("d039"),o=n("ad6d"),s="toString",c=RegExp.prototype,l=c[s],d=i((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),u=l.name!=s;(d||u)&&r(RegExp.prototype,s,(function(){var e=a(this),t=String(e.source),n=e.flags,r=String(void 0===n&&e instanceof RegExp&&!("flags"in c)?o.call(e):n);return"/"+t+"/"+r}),{unsafe:!0})},"4de4":function(e,t,n){"use strict";var r=n("23e7"),a=n("b727").filter,i=n("1dde"),o=n("ae40"),s=i("filter"),c=o("filter");r({target:"Array",proto:!0,forced:!s||!c},{filter:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},5530:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("a4d3"),n("4de4"),n("4160"),n("e439"),n("dbb4"),n("b64b"),n("159b");function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},"5a34":function(e,t,n){var r=n("44e7");e.exports=function(e){if(r(e))throw TypeError("The method doesn't accept regular expressions");return e}},"6a7e":function(e,t,n){},"6e21":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dashboard-container"},[n("a-row",{attrs:{type:"flex",justify:"center",align:"top",gutter:16}},[n("a-col",{attrs:{xs:{span:7},xl:{span:5},xxl:{span:5}}},[n("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[n("a-input",{attrs:{placeholder:"过滤",icon:"FilterOutlined"},model:{value:e.filterValue,callback:function(t){e.filterValue=t},expression:"filterValue"}},[n("a-icon",{attrs:{slot:"suffix",type:"filter"},slot:"suffix"})],1),n("a-dropdown",{attrs:{trigger:["click"]}},[n("a-menu",{attrs:{slot:"overlay"},on:{click:e.handleMenuClick},slot:"overlay"},[n("a-menu-item",{key:"文件夹"},[n("a-icon",{attrs:{type:"folder"}}),e._v("创建文件夹 ")],1),n("a-menu-item",{key:"仪表盘"},[n("a-icon",{attrs:{type:"dashboard"}}),e._v("创建仪表盘 ")],1)],1),n("div",[n("a-button",{staticStyle:{"margin-left":"5px"},attrs:{icon:"plus"}})],1)],1)],1),n("div",{staticClass:"catalogue-container"},[e.treeData.length>0?n("a-tree",{attrs:{"show-icon":"","tree-data":e.filteredTreeData,defaultExpandedKeys:e.defaultExpandedKeys,selectedKeys:e.defaultSelectedKeys},on:{expand:e.expandNode,select:e.selectNode,"update:selectedKeys":function(t){e.defaultSelectedKeys=t},"update:selected-keys":function(t){e.defaultSelectedKeys=t}},scopedSlots:e._u([{key:"folder",fn:function(e){var t=e.expanded;return[n("a-icon",{staticClass:"tree-icon",attrs:{theme:"outlined",type:t?"folder-open":"folder"}})]}},{key:"title",fn:function(t){return[t.folder?[e._v(e._s(t.title))]:n("a-tooltip",{attrs:{overlayClassName:"tooltip",placement:"right",overlayStyle:{background:"#fff"}}},[n("template",{slot:"title"},["dashboard"===e.item?[n("div",[e._v("名称："+e._s(t.title))]),n("div",[e._v("备注："+e._s(t.remarks))])]:e._e(),"workSheet"===e.item?[n("div",[e._v("名称："+e._s(t.title))]),n("div",[e._v("原名："+e._s(t.tableName))]),n("div",[e._v("描述："+e._s(t.description))])]:e._e()],2),e._v(" "+e._s(t.title)+" ")],2)]}}],null,!1,2447245915)},[n("a-icon",{staticClass:"tree-icon",attrs:{slot:e.item,theme:"outlined",type:e.treeIcon},slot:e.item})],1):e._e()],1)]),n("a-col",{attrs:{xs:{span:17},xl:{span:19},xxl:{span:19}}},[n("div",{staticClass:"right-container"},[e.dashboardLoading?n("a-spin",{staticClass:"spin",attrs:{tip:"仪表盘加载中……"}}):[e._t("right-container")]],2)])],1),n("a-modal",{attrs:{title:"新建"+e.menuKey,visible:e.visible,"confirm-loading":e.confirmLoading,destroyOnClose:!0},on:{ok:e.handleOk,cancel:function(){e.visible=!1,e.form={parentId:""}}}},[n("a-form-model",e._b({model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},"a-form-model",{labelCol:{span:6},wrapperCol:{span:16}},!1),[n("a-form-model-item",{attrs:{label:"所属文件夹"}},[n("a-tree-select",{staticStyle:{width:"100%"},attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.selectedTreeData,"tree-default-expand-all":""},model:{value:e.form.parentId,callback:function(t){e.$set(e.form,"parentId",t)},expression:"form.parentId"}})],1),n("a-form-model-item",{attrs:{label:e.menuKey+"名称"}},[n("a-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),"仪表盘"==e.menuKey?n("a-form-model-item",{attrs:{label:e.menuKey+"备注"}},[n("a-input",{attrs:{type:"textarea"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1):e._e()],1)],1)],1)},a=[],i=(n("4de4"),n("4160"),n("caad"),n("d81d"),n("b0c0"),n("2532"),n("159b"),n("5530"));function o(e,t){localStorage.setItem(e,JSON.stringify(t))}function s(e){return JSON.parse(localStorage.getItem(e))}function c(e){return e.filter((function(e){return e.folder})).map((function(e){return Object(i["a"])(Object(i["a"])({},e),{},{selectable:!0,children:c(e.children)})}))}function l(e,t){var n=[];return e.forEach((function(e){if(e.isLeaf)e.title.includes(t)&&n.push(e);else{var r=Object(i["a"])(Object(i["a"])({},e),{},{children:l(e.children,t)});r.children.length>0&&n.push(r)}})),n}var d={props:["item"],data:function(){return{treeData:[],defaultExpandedKeys:[],defaultSelectedKeys:[],filterValue:"",visible:!1,confirmLoading:!1,menuKey:"",form:{parentId:""},dashboard:{},dashboardLoading:!0}},created:function(){this.init()},components:{},computed:{selectedKeysLocalKey:function(){return"".concat(this.item,"_selectedKeys")},expandedKeysLocalKey:function(){return"".concat(this.item,"_expandedKeys")},selectedRefIdKey:function(){return"".concat(this.item,"_ref_id")},filteredTreeData:function(){return l(this.treeData,this.filterValue)},selectedTreeData:function(){return c(this.treeData)},treeIcon:function(){return"workSheet"===this.item?"table":this.item}},methods:{init:function(){var e=this;this.defaultSelectedKeys=s(this.selectedKeysLocalKey),this.defaultExpandedKeys=s(this.expandedKeysLocalKey);var t=s(this.selectedRefIdKey);this.$axios.get("/".concat(this.item,"/catalogue")).then((function(n){var r=[{name:"根目录",id:0,refId:0,folder:!0,children:n}],a=r.map((function(t){return e.convert2Node(t)}));e.treeData=a,null!=t?e.chooseDashboard(t):e.dashboardLoading=!1}))},selectNode:function(e,t){var n=t.node;o(this.selectedKeysLocalKey,e),this.selectedKeys=e,n.dataRef.folder||(o(this.selectedRefIdKey,n.dataRef.refId),n.selected||this.chooseDashboard(n.dataRef.refId))},expandNode:function(e){o(this.expandedKeysLocalKey,e)},handleMenuClick:function(e){this.menuKey=e.key,this.visible=!0},chooseDashboard:function(e){this.dashboardLoading=!0,this.$emit("choose",e)},loaded:function(){this.dashboardLoading=!1},handleOk:function(){var e=this;if(""!==this.form.parentId){var t="/".concat(this.item);"文件夹"===this.menuKey&&(t+="/folder"),this.confirmLoading=!0,this.$axios.post(t,this.form).then((function(t){t&&(e.confirmLoading=!1,e.$message.success("创建".concat(e.menuKey,"成功！")),e.visible=!1,"文件夹"!==e.menuKey&&(o(e.selectedKeysLocalKey,["node_".concat(t.nodeId)]),o(e.selectedRefIdKey,t.dashboardId)),e.init())})).catch((function(){e.confirmLoading=!1}))}else this.$message.error("所属文件夹不能为空！")},convert2Node:function(e){var t=this,n=Object(i["a"])(Object(i["a"])({title:e.name},e),{},{key:"node_"+e.id,value:e.id,isLeaf:!e.folder||0===e.children.length,children:e.children.map((function(e){return t.convert2Node(e)})),selectable:!e.folder});return e.folder?n.scopedSlots={icon:"folder",title:"title"}:n.scopedSlots={icon:this.item,title:"title"},n}}},u=d,f=(n("6e4a"),n("2877")),h=Object(f["a"])(u,r,a,!1,null,null,null);t["a"]=h.exports},"6e4a":function(e,t,n){"use strict";var r=n("6a7e"),a=n.n(r);a.a},"746f":function(e,t,n){var r=n("428f"),a=n("5135"),i=n("e5383"),o=n("9bf2").f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});a(t,e)||o(t,e,{value:i.f(e)})}},7680:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("catalogue",{ref:"catRef",attrs:{item:"workSheet"},on:{choose:e.chooseWorkSheet}},[n("template",{slot:"right-container"},[n("work-sheet-detail",{attrs:{data:e.workSheet}})],1)],2)],1)},a=[],i=n("6e21"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"work-sheet-detail-container"},[n("div",{staticClass:"work-sheet-header"},[n("div",{staticClass:"title"},[e._v(" "+e._s(e.data.title)+" "),n("div",{staticClass:"description"},[e._v(e._s(e.data.description||"该表没有描述，赶紧加上"))])]),n("div",{staticClass:"button-list"},[n("a-button",{attrs:{icon:"bar-chart"}},[e._v("新建图表")]),n("a-button",{attrs:{icon:"file-excel"}},[e._v("上传数据")]),n("a-button",{attrs:{icon:"share-alt"}},[e._v("创建合表")])],1)]),n("a-tabs",{staticClass:"tabs",attrs:{"default-active-key":"2"},on:{change:e.chooseTab}},[n("a-tab-pane",{key:"1",attrs:{tab:"数据预览"}},[n("preview",{attrs:{"work-sheet":e.data}})],1),n("a-tab-pane",{key:"2",attrs:{tab:"字段设置","force-render":""}},[n("field-list",{attrs:{data:e.data.fields}})],1)],1)],1)},s=[],c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"preview-container"},[n("div",{staticClass:"data-container"},[n("a-table",{style:{"word-break":"break-all"},attrs:{"table-layout":"auto",size:"small",pagination:!1,"data-source":e.sheetData,columns:e.columns,scroll:{x:1600,y:500}}})],1)])},l=[],d=(n("4160"),n("d81d"),n("b0c0"),n("d3b7"),n("25f0"),n("159b"),n("5530")),u={props:["workSheet"],data:function(){return{previewCondition:{fields:[],sql:"",wheres:[],whereType:"condition",linker:"and",order:{name:"",desc:!0}},sheetData:[]}},computed:{columns:function(){var e=this.sheetData,t={};return e.forEach((function(e){for(var n in e){var r=e[n].toString().length||0,a=t[n];(void 0===a||a<r)&&(t[n]=r)}})),this.workSheet.fields.forEach((function(e){e.width=10*t[e.name]+20})),this.workSheet.fields.map((function(e){var t={dataIndex:e.name,title:e.title,width:e.width};return t}))}},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;this.$axios.post("/workSheet/preview",Object(d["a"])({workSheetId:this.workSheet.id},this.previewCondition)).then((function(t){e.sheetData=t.data}))}}},f=u,h=(n("8f55"),n("2877")),p=Object(h["a"])(f,c,l,!1,null,null,null),m=p.exports,b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-table",{attrs:{pagination:!1,size:"small","data-source":e.data,columns:e.columns}})],1)},v=[],y=[{title:"行数",dataIndex:"seqNo"},{title:"原字段名",dataIndex:"name"},{title:"新字段名",dataIndex:"title"},{title:"字段类型",dataIndex:"type",scopedSlots:{customRender:"type"}},{title:"字段描述",dataIndex:"remarks"}],g={props:["data"],data:function(){return{columns:y}}},w=g,x=Object(h["a"])(w,b,v,!1,null,null,null),O=x.exports,S={props:["data"],data:function(){return{tabKey:2}},components:{FieldList:O,Preview:m},methods:{chooseTab:function(){}}},k=S,_=(n("1688"),Object(h["a"])(k,o,s,!1,null,null,null)),K=_.exports,j={data:function(){return{workSheet:{}}},components:{Catalogue:i["a"],WorkSheetDetail:K},methods:{chooseWorkSheet:function(e){var t=this;this.$axios.get("/workSheet?id=".concat(e)).then((function(e){t.workSheet=e,t.$refs.catRef.loaded()}))}}},I=j,C=Object(h["a"])(I,r,a,!1,null,null,null);t["default"]=C.exports},8092:function(e,t,n){},"8f55":function(e,t,n){"use strict";var r=n("1860"),a=n.n(r);a.a},a4d3:function(e,t,n){"use strict";var r=n("23e7"),a=n("da84"),i=n("d066"),o=n("c430"),s=n("83ab"),c=n("4930"),l=n("fdbf"),d=n("d039"),u=n("5135"),f=n("e8b5"),h=n("861d"),p=n("825a"),m=n("7b0b"),b=n("fc6a"),v=n("c04e"),y=n("5c6c"),g=n("7c73"),w=n("df75"),x=n("241c"),O=n("057f"),S=n("7418"),k=n("06cf"),_=n("9bf2"),K=n("d1e7"),j=n("9112"),I=n("6eeb"),C=n("5692"),D=n("f772"),E=n("d012"),P=n("90e3"),L=n("b622"),N=n("e5383"),$=n("746f"),R=n("d44e"),T=n("69f3"),J=n("b727").forEach,V=D("hidden"),F="Symbol",W="prototype",A=L("toPrimitive"),q=T.set,z=T.getterFor(F),M=Object[W],H=a.Symbol,Q=i("JSON","stringify"),B=k.f,G=_.f,U=O.f,X=K.f,Y=C("symbols"),Z=C("op-symbols"),ee=C("string-to-symbol-registry"),te=C("symbol-to-string-registry"),ne=C("wks"),re=a.QObject,ae=!re||!re[W]||!re[W].findChild,ie=s&&d((function(){return 7!=g(G({},"a",{get:function(){return G(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=B(M,t);r&&delete M[t],G(e,t,n),r&&e!==M&&G(M,t,r)}:G,oe=function(e,t){var n=Y[e]=g(H[W]);return q(n,{type:F,tag:e,description:t}),s||(n.description=t),n},se=l?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof H},ce=function(e,t,n){e===M&&ce(Z,t,n),p(e);var r=v(t,!0);return p(n),u(Y,r)?(n.enumerable?(u(e,V)&&e[V][r]&&(e[V][r]=!1),n=g(n,{enumerable:y(0,!1)})):(u(e,V)||G(e,V,y(1,{})),e[V][r]=!0),ie(e,r,n)):G(e,r,n)},le=function(e,t){p(e);var n=b(t),r=w(n).concat(pe(n));return J(r,(function(t){s&&!ue.call(n,t)||ce(e,t,n[t])})),e},de=function(e,t){return void 0===t?g(e):le(g(e),t)},ue=function(e){var t=v(e,!0),n=X.call(this,t);return!(this===M&&u(Y,t)&&!u(Z,t))&&(!(n||!u(this,t)||!u(Y,t)||u(this,V)&&this[V][t])||n)},fe=function(e,t){var n=b(e),r=v(t,!0);if(n!==M||!u(Y,r)||u(Z,r)){var a=B(n,r);return!a||!u(Y,r)||u(n,V)&&n[V][r]||(a.enumerable=!0),a}},he=function(e){var t=U(b(e)),n=[];return J(t,(function(e){u(Y,e)||u(E,e)||n.push(e)})),n},pe=function(e){var t=e===M,n=U(t?Z:b(e)),r=[];return J(n,(function(e){!u(Y,e)||t&&!u(M,e)||r.push(Y[e])})),r};if(c||(H=function(){if(this instanceof H)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=P(e),n=function(e){this===M&&n.call(Z,e),u(this,V)&&u(this[V],t)&&(this[V][t]=!1),ie(this,t,y(1,e))};return s&&ae&&ie(M,t,{configurable:!0,set:n}),oe(t,e)},I(H[W],"toString",(function(){return z(this).tag})),I(H,"withoutSetter",(function(e){return oe(P(e),e)})),K.f=ue,_.f=ce,k.f=fe,x.f=O.f=he,S.f=pe,N.f=function(e){return oe(L(e),e)},s&&(G(H[W],"description",{configurable:!0,get:function(){return z(this).description}}),o||I(M,"propertyIsEnumerable",ue,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!c,sham:!c},{Symbol:H}),J(w(ne),(function(e){$(e)})),r({target:F,stat:!0,forced:!c},{for:function(e){var t=String(e);if(u(ee,t))return ee[t];var n=H(t);return ee[t]=n,te[n]=t,n},keyFor:function(e){if(!se(e))throw TypeError(e+" is not a symbol");if(u(te,e))return te[e]},useSetter:function(){ae=!0},useSimple:function(){ae=!1}}),r({target:"Object",stat:!0,forced:!c,sham:!s},{create:de,defineProperty:ce,defineProperties:le,getOwnPropertyDescriptor:fe}),r({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:he,getOwnPropertySymbols:pe}),r({target:"Object",stat:!0,forced:d((function(){S.f(1)}))},{getOwnPropertySymbols:function(e){return S.f(m(e))}}),Q){var me=!c||d((function(){var e=H();return"[null]"!=Q([e])||"{}"!=Q({a:e})||"{}"!=Q(Object(e))}));r({target:"JSON",stat:!0,forced:me},{stringify:function(e,t,n){var r,a=[e],i=1;while(arguments.length>i)a.push(arguments[i++]);if(r=t,(h(t)||void 0!==e)&&!se(e))return f(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!se(t))return t}),a[1]=t,Q.apply(null,a)}})}H[W][A]||j(H[W],A,H[W].valueOf),R(H,F),E[V]=!0},ab13:function(e,t,n){var r=n("b622"),a=r("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[a]=!1,"/./"[e](t)}catch(r){}}return!1}},caad:function(e,t,n){"use strict";var r=n("23e7"),a=n("4d64").includes,i=n("44d2"),o=n("ae40"),s=o("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:!s},{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),i("includes")},dbb4:function(e,t,n){var r=n("23e7"),a=n("83ab"),i=n("56ef"),o=n("fc6a"),s=n("06cf"),c=n("8418");r({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(e){var t,n,r=o(e),a=s.f,l=i(r),d={},u=0;while(l.length>u)n=a(r,t=l[u++]),void 0!==n&&c(d,t,n);return d}})},e439:function(e,t,n){var r=n("23e7"),a=n("d039"),i=n("fc6a"),o=n("06cf").f,s=n("83ab"),c=a((function(){o(1)})),l=!s||c;r({target:"Object",stat:!0,forced:l,sham:!s},{getOwnPropertyDescriptor:function(e,t){return o(i(e),t)}})},e5383:function(e,t,n){var r=n("b622");t.f=r}}]);
//# sourceMappingURL=chunk-db514600.4be932ac.js.map